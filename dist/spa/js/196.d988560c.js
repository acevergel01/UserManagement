"use strict";(self["webpackChunkapp"]=self["webpackChunkapp"]||[]).push([[196],{8931:(e,a,t)=>{t.d(a,{Z:()=>n});var s=t(6417);const i=(e,a)=>{s.Z.create({type:a,message:e,position:"bottom-right"})},l={show:i},o=e=>{if(e.data)l.show(e.data.message,"positive");else{let a="";if(e.response.status<500)for(let t in e.response.data.errors)a=e.response.data.errors[t][0];else a="Internal server error. Try again later";l.show(a,"negative")}},n={show:o}},9196:(e,a,t)=>{t.r(a),t.d(a,{default:()=>z});var s=t(3673),i=t(2323),l=t(8880);const o={key:0,class:"text-h5 absolute-center"},n={key:1,flat:"",class:"q-pa-md"},d=(0,s._)("thead",{class:"bg-light-blue"},[(0,s._)("tr",null,[(0,s._)("th",{colspan:"7"},[(0,s._)("div",{class:"text-h5 q-my-sm text-left"},"User Information")])]),(0,s._)("tr",null,[(0,s._)("th",{class:"text-center"},"ID"),(0,s._)("th",{class:"text-center"},"Username"),(0,s._)("th",{class:"text-center"},"Email"),(0,s._)("th",{class:"text-center"},"Age"),(0,s._)("th",{class:"text-center"},"Birthday"),(0,s._)("th",{class:"text-center"},"Actions")])],-1),r={class:"text-left"},u={class:"text-right"},c={class:"text-right"},m={class:"text-right"},h={class:"text-right"},p={key:0},w={colspan:"7"},f={class:"row q-px-lg q-pt-md"},g=(0,s._)("div",null,null,-1),y={class:"row q-px-lg"},_={key:0,class:"row q-px-lg"},k={class:"row q-px-lg"},b={class:"row items-center justify-end"},q=(0,s.Uk)(" Change Password ");function D(e,a,t,D,W,x){const v=(0,s.up)("q-btn"),C=(0,s.up)("q-markup-table"),Z=(0,s.up)("q-icon"),U=(0,s.up)("q-input"),P=(0,s.up)("q-date"),V=(0,s.up)("q-popup-proxy"),I=(0,s.up)("q-card-actions"),$=(0,s.up)("q-form"),Q=(0,s.up)("q-card"),A=(0,s.up)("q-dialog"),H=(0,s.up)("q-card-section"),L=(0,s.up)("q-page"),M=(0,s.Q2)("close-popup");return x.isLoading?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(L,{key:0,class:"flex flex-top"},{default:(0,s.w5)((()=>[W.canAccess?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",o," You do not have permission to access this page ")),W.canAccess?((0,s.wg)(),(0,s.iD)("div",n,[(0,s.Wm)(C,null,{default:(0,s.w5)((()=>[d,(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(W.userData,((e,a)=>((0,s.wg)(),(0,s.iD)("tr",{key:e.id},[(0,s._)("td",r,(0,i.zw)(e.id),1),(0,s._)("td",u,(0,i.zw)(e.username),1),(0,s._)("td",c,(0,i.zw)(e.email),1),(0,s._)("td",m,(0,i.zw)(e.age),1),(0,s._)("td",h,(0,i.zw)(e.birthday),1),(0,s._)("td",null,[W.canDelete?((0,s.wg)(),(0,s.j4)(v,{key:0,flat:"",icon:"delete",color:"negative",round:"",onClick:e=>x.deleteItem(a)},null,8,["onClick"])):(0,s.kq)("",!0),W.canUpdate?((0,s.wg)(),(0,s.j4)(v,{key:1,class:"q-pa-sm float-center",onClick:e=>{x.show(),x.setItems(a,"update")},color:"positive",round:"",flat:"",icon:"edit"},null,8,["onClick"])):(0,s.kq)("",!0),W.canUpdate?((0,s.wg)(),(0,s.j4)(v,{key:2,class:"q-pa-sm float-right",onClick:e=>x.setItems(a,"changepass"),icon:"lock",color:"positive",round:"",flat:""},null,8,["onClick"])):(0,s.kq)("",!0)])])))),128)),W.canAdd?((0,s.wg)(),(0,s.iD)("tr",p,[(0,s._)("td",w,[(0,s.Wm)(v,{class:"float-right",color:"blue",icon:"add_circle",flat:"",outlined:"",round:"",onClick:a[0]||(a[0]=e=>{x.show(),x.setItems(0,"add")})})])])):(0,s.kq)("",!0)])])),_:1})])):(0,s.kq)("",!0),(0,s.Wm)(A,{ref:"dialog",onHide:x.onDialogHide},{default:(0,s.w5)((()=>[(0,s.Wm)(Q,{class:"q-dialog-plugin"},{default:(0,s.w5)((()=>[(0,s.Wm)($,{onSubmit:x.onOKClick},{default:(0,s.w5)((()=>[(0,s._)("div",f,[(0,s.Wm)(U,{readonly:x.isUpdating,class:"col",outlined:"",type:"text",modelValue:W.form.username,"onUpdate:modelValue":a[2]||(a[2]=e=>W.form.username=e),label:"Username",rules:[e=>!!e||"Field is required"]},(0,s.Nv)({prepend:(0,s.w5)((()=>[(0,s.Wm)(Z,{round:"",dense:"",flat:"",name:"person"})])),_:2},[W.form.username&&!x.isUpdating?{name:"append",fn:(0,s.w5)((()=>[(0,s.Wm)(Z,{name:"cancel",onClick:a[1]||(a[1]=(0,l.iM)((e=>W.form.username=null),["stop"])),class:"cursor-pointer"})]))}:void 0]),1032,["readonly","modelValue","rules"]),g]),(0,s._)("div",y,[(0,s.Wm)(U,{class:"col",outlined:"",type:"email",modelValue:W.form.email,"onUpdate:modelValue":a[4]||(a[4]=e=>W.form.email=e),label:"Email",rules:[e=>!!e||"Field is required"]},(0,s.Nv)({prepend:(0,s.w5)((()=>[(0,s.Wm)(Z,{round:"",dense:"",flat:"",name:"person"})])),_:2},[W.form.email?{name:"append",fn:(0,s.w5)((()=>[(0,s.Wm)(Z,{name:"cancel",onClick:a[3]||(a[3]=(0,l.iM)((e=>W.form.email=null),["stop"])),class:"cursor-pointer"})]))}:void 0]),1032,["modelValue","rules"])]),x.isUpdating?(0,s.kq)("",!0):((0,s.wg)(),(0,s.iD)("div",_,[(0,s.Wm)(U,{class:"col",modelValue:W.form.password,"onUpdate:modelValue":a[6]||(a[6]=e=>W.form.password=e),outlined:"",type:W.isPwd?"password":"text",label:"Password",rules:[e=>!!e||"Field is required"]},{append:(0,s.w5)((()=>[(0,s.Wm)(Z,{round:"",dense:"",flat:"",name:W.isPwd?"visibility_off":"visibility",class:"cursor-pointer",onClick:a[5]||(a[5]=(0,l.iM)((e=>W.isPwd=!W.isPwd),["stop"]))},null,8,["name"])])),prepend:(0,s.w5)((()=>[(0,s.Wm)(Z,{round:"",dense:"",flat:"",name:"lock"})])),_:1},8,["modelValue","type","rules"])])),(0,s._)("div",k,[(0,s.Wm)(U,{class:"col",style:{"min-width":"50%"},outlined:"",modelValue:W.form.birthday,"onUpdate:modelValue":a[8]||(a[8]=e=>W.form.birthday=e),mask:"date",rules:["date"],label:"Birthday YYYY/MM/DD"},{prepend:(0,s.w5)((()=>[(0,s.Wm)(Z,{name:"event",class:"cursor-pointer"},{default:(0,s.w5)((()=>[(0,s.Wm)(V,{ref:"qDateProxy","transition-show":"scale","transition-hide":"scale"},{default:(0,s.w5)((()=>[(0,s.Wm)(P,{modelValue:W.form.birthday,"onUpdate:modelValue":a[7]||(a[7]=e=>W.form.birthday=e),title:"Birthday"},{default:(0,s.w5)((()=>[(0,s._)("div",b,[(0,s.wy)((0,s.Wm)(v,{label:"Close",color:"primary",flat:""},null,512),[[M]])])])),_:1},8,["modelValue"])])),_:1},512)])),_:1})])),_:1},8,["modelValue"])]),(0,s.Wm)(I,{align:"right"},{default:(0,s.w5)((()=>[(0,s.Wm)(v,{label:"Save",type:"submit",color:"primary"}),(0,s.Wm)(v,{color:"primary",label:"Cancel",onClick:x.hide},null,8,["onClick"])])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["onHide"]),(0,s.Wm)(A,{onHide:x.onDialogHide,ref:"passworddialog"},{default:(0,s.w5)((()=>[(0,s.Wm)(Q,null,{default:(0,s.w5)((()=>[(0,s.Wm)($,{onSubmit:x.changePassword},{default:(0,s.w5)((()=>[(0,s.Wm)(H,{class:"text-left text-h5"},{default:(0,s.w5)((()=>[q])),_:1}),(0,s.Wm)(H,{class:"row"},{default:(0,s.w5)((()=>[(0,s.Wm)(U,{class:"col",modelValue:W.form.password,"onUpdate:modelValue":a[10]||(a[10]=e=>W.form.password=e),outlined:"",type:W.isPwd?"password":"text",label:"New Password",rules:[e=>!!e||"Field is required"]},{append:(0,s.w5)((()=>[(0,s.Wm)(Z,{round:"",dense:"",flat:"",name:W.isPwd?"visibility_off":"visibility",class:"cursor-pointer",onClick:a[9]||(a[9]=(0,l.iM)((e=>W.isPwd=!W.isPwd),["stop"]))},null,8,["name"])])),prepend:(0,s.w5)((()=>[(0,s.Wm)(Z,{round:"",dense:"",flat:"",name:"lock"})])),_:1},8,["modelValue","type","rules"])])),_:1}),(0,s.Wm)(I,{align:"right"},{default:(0,s.w5)((()=>[(0,s.Wm)(v,{label:"Submit",type:"submit",color:"primary"}),(0,s.Wm)(v,{color:"primary",label:"Cancel",onClick:x.hide},null,8,["onClick"])])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1},8,["onHide"])])),_:1}))}var W=t(8825),x=t(8931);const v={name:"UserInfo",setup(){const e=(0,W.Z)();return{showLoading(a){e.loading.show({delay:a})},hideLoading(){e.loading.hide()}}},data(){return{loading:!0,canAccess:1,canAdd:0,canUpdate:0,canDelete:0,type:"",isPwd:!0,editDialog:!1,action:"",newPassword:"",userData:[],form:{username:"",email:"",password:"",birthday:"",age:""}}},computed:{isUpdating:function(){return"update"==this.action},isChangingpass:function(){return"changepass"==this.action},isLoading:function(){return this.loading}},beforeCreate(){this.loading=!0,this.showLoading();let e=this;this.$api.get("api/userinfo").then((a=>{this.hideLoading(),e.setData(a),this.loading=!1})).catch((a=>{console.log(a),e.$router.push("/login"),this.hideLoading()}))},methods:{setItems(e,a){this.action=a,this.index=e,this.isUpdating?(this.form.username=this.userData[e].username,this.form.email=this.userData[e].email,this.form.age=this.userData[e].age,this.form.birthday=this.userData[e].birthday):this.isChangingpass?(this.form.password=null,this.$refs.passworddialog.show()):(this.form.username=null,this.form.email=null,this.form.password=null,this.form.birthday=null)},show(){this.$refs.dialog.show()},hide(){this.$refs.dialog.hide(),this.$refs.passworddialog.hide()},onDialogHide(){this.$emit("hide"),this.action=""},onOKClick(){this.isUpdating?this.editUser(this.index):this.addItem()},editUser(){let e=this.index,a=this.userData[e].id;this.$api.put(`api/user/${a}`,this.form).then((a=>{this.userData[e]=a.data.user,x.Z.show(a),this.hide()})).catch((e=>{x.Z.show(e)}))},changePassword(){let e=this.index,a=this.userData[e].id;this.$api.put(`api/changepass/user/${a}`,this.form).then((e=>{x.Z.show(e),this.hide()})).catch((e=>{x.Z.show(e)}))},deleteItem(e){let a=this.userData[e].id;this.$api.delete(`api/user/${a}`).then((a=>{x.Z.show(a),this.userData.splice(e,1)})).catch((e=>{x.Z.show(e)}))},addItem(){this.$api.post("api/user",this.form).then((e=>{this.userData.push(e.data.user),x.Z.show(e),this.hide()})).catch((e=>{x.Z.show(e)}))},setData(e){this.canAccess=e.data.ui_access,this.canDelete=e.data.ui_delete,this.canUpdate=e.data.ui_update,this.canAdd=e.data.ui_add,this.userData=e.data.users}}};var C=t(4379),Z=t(481),U=t(8240),P=t(6778),V=t(151),I=t(8689),$=t(4842),Q=t(4554),A=t(3944),H=t(3124),L=t(9367),M=t(5589),S=t(677),Y=t(7518),j=t.n(Y);v.render=D;const z=v;j()(v,"components",{QPage:C.Z,QMarkupTable:Z.Z,QBtn:U.Z,QDialog:P.Z,QCard:V.Z,QForm:I.Z,QInput:$.Z,QIcon:Q.Z,QPopupProxy:A.Z,QDate:H.Z,QCardActions:L.Z,QCardSection:M.Z}),j()(v,"directives",{ClosePopup:S.Z})}}]);